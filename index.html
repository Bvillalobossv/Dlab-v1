<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RaiZen</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="https://cdn.jsdelivr.net/npm/face-api.js@0.22.2/dist/face-api.min.js"></script>
</head>
<body>

  <!-- ====================== ONBOARDING ====================== -->
  <div id="screenIntro" class="screen active">
    <div class="carousel-shell">
      <div class="slides" id="introSlides">
        <section class="slide">
          <img src="https://i.imgur.com/8a5g8G3.png" alt="Bienestar en el trabajo" class="slide-image"/>
          <div class="slide-text">
            <h2>Bienvenido a RaiZen</h2>
            <p>Tu espacio para conectar con tu bienestar laboral y encontrar el equilibrio, d√≠a a d√≠a.</p>
          </div>
        </section>
        <section class="slide">
          <img src="https://i.imgur.com/sL3b5x2.png" alt="Privacidad" class="slide-image"/>
          <div class="slide-text">
            <h2>Tu Privacidad es Sagrada</h2>
            <p>Tus datos se procesan de forma segura y an√≥nima. Tu bienestar es personal y aqu√≠ lo respetamos.</p>
          </div>
        </section>
        <section class="slide">
          <img src="https://i.imgur.com/yXF8AFs.png" alt="An√°lisis r√°pido" class="slide-image"/>
          <div class="slide-text">
            <h2>Un Check-in en Minutos</h2>
            <p>Con solo 4 pasos, obtendr√°s una visi√≥n clara de tu estado actual para tomar mejores decisiones en tu jornada.</p>
          </div>
        </section>
      </div>
      <div class="dots" id="introDots"></div>
      <div class="stack-sm">
        <button id="introPrev" class="btn btn-secondary">Anterior</button>
        <button id="introNext" class="btn">Siguiente</button>
        <button id="introStart" class="btn" style="display:none">¬°Comenzar!</button>
      </div>
    </div>
  </div>

  <!-- ====================== AUTH ====================== -->
  <div id="screenAuth" class="screen">
    <img src="https://i.imgur.com/dJ88p2F.png" alt="Logo RaiZen" class="logo" />
    <h1>RaiZen</h1>
    <p class="lead">Inicia tu camino hacia el equilibrio.</p>
    <div class="card max-600">
      <div class="segmented">
        <button id="authTabLogin" class="segment active">Iniciar sesi√≥n</button>
        <button id="authTabSignup" class="segment">Crear cuenta</button>
      </div>
      <form id="formLogin" class="form">
        <div class="form-row"><label>Usuario</label><input type="text" id="login_user" autocomplete="username" required /></div>
        <div class="form-row"><label>Contrase√±a</label><input type="password" id="login_pass" autocomplete="current-password" required /></div>
        <button type="submit" class="btn">Entrar</button>
      </form>
      <form id="formSignup" class="form" style="display:none">
        <div class="form-row"><label>Nuevo usuario</label><input type="text" id="su_user" autocomplete="username" required /></div>
        <div class="form-row"><label>Contrase√±a (m√≠nimo 6 caracteres)</label><input type="password" id="su_pass" autocomplete="new-password" minlength="6" required /></div>
        <div class="form-row chk"><label><input type="checkbox" id="su_terms" required /> He le√≠do y acepto los <a href="#" id="view-terms-link">T√©rminos y Condiciones</a></label></div>
        <button type="submit" class="btn">Crear cuenta</button>
      </form>
      <p id="auth-message" class="muted small"></p>
    </div>
  </div>

  <!-- ====================== T√âRMINOS Y CONDICIONES ====================== -->
  <div id="screenTerms" class="screen">
      <div class="card max-700 text-left">
          <h2>T√©rminos y Condiciones de RaiZen</h2>
          <p><strong>√öltima actualizaci√≥n: 14 de Octubre, 2025</strong></p>
          <p>Bienvenido a RaiZen. Al utilizar nuestra aplicaci√≥n, aceptas los siguientes t√©rminos:</p>
          <h4>1. Prop√≥sito de la Aplicaci√≥n</h4>
          <p>RaiZen es una herramienta dise√±ada para ayudarte a monitorear y gestionar tu bienestar laboral. Las mediciones (emocionales, ambientales y f√≠sicas) son estimaciones y no deben ser consideradas como un diagn√≥stico m√©dico.</p>
          <h4>2. Privacidad y Uso de Datos</h4>
          <p>Tu privacidad es nuestra m√°xima prioridad. Todos los an√°lisis de c√°mara (emoci√≥n) y micr√≥fono (ruido) se procesan directamente en tu dispositivo y nunca se almacenan ni se env√≠an a nuestros servidores.</p>
          <ul>
              <li><strong>Datos Recopilados:</strong> Guardamos de forma an√≥nima y segura en nuestra base de datos (Supabase) √∫nicamente los resultados de tus mediciones (ej. emoci√≥n "feliz", nivel de ruido "54 dB", puntaje "8/10") y tus comentarios opcionales.</li>
              <li><strong>Finalidad:</strong> Estos datos se utilizan para mostrarte tu historial de bienestar y para que tu empleador (RRHH) pueda visualizar m√©tricas generales y an√≥nimas del bienestar del equipo, identificando tendencias y √°reas de mejora en el ambiente laboral.</li>
              <li><strong>Confidencialidad:</strong> Tu empleador solo ver√° datos agregados o identificar√° niveles de riesgo sin acceder a los detalles espec√≠ficos de cada medici√≥n individual, a menos que sea estrictamente necesario para ofrecer apoyo.</li>
          </ul>
          <h4>3. Responsabilidades del Usuario</h4>
          <p>Aceptas utilizar la aplicaci√≥n de manera responsable. Eres responsable de la seguridad de tu cuenta y contrase√±a.</p>
          <h4>4. Limitaci√≥n de Responsabilidad</h4>
          <p>RaiZen se proporciona "tal cual", sin garant√≠as de ning√∫n tipo. No nos hacemos responsables de las decisiones que tomes basadas en la informaci√≥n proporcionada por la aplicaci√≥n.</p>
          <button id="close-terms-button" class="btn">Entendido</button>
      </div>
  </div>


  <!-- ====================== SELFIE EMOCIONAL ====================== -->
  <div id="screenFace" class="screen">
    <div class="step-header">
      <span class="step-counter">Paso 1 de 4</span>
      <h2>An√°lisis Facial</h2>
      <p class="lead">Una selfie para empezar el d√≠a. Tu rostro nos da pistas sobre tu estado de √°nimo.</p>
    </div>
    <div class="card max-900">
      <div class="two-cols">
        <div>
          <video id="faceVideo" playsinline muted class="video"></video>
          <canvas id="faceCanvas" class="video" style="display:none"></canvas>
          <div class="stack-sm">
            <button id="btnFaceStart" class="btn">üì∏ Activar c√°mara</button>
            <button id="btnFaceSnap" class="btn btn-outline" disabled>Analizar mi expresi√≥n</button>
          </div>
          <p id="faceHelp" class="muted small">Aseg√∫rate de que tu rostro est√© bien iluminado y centrado.</p>
        </div>
        <div class="results-container">
          <h3>Tu Resultado Emocional</h3>
          <p class="muted small">(Desliza hacia abajo para ver)</p>
          <div id="face-results-content" class="hidden">
            <p><b>Emoci√≥n dominante:</b> <span id="faceEmotion">‚Äî</span></p>
            <p><b>Confianza:</b> <span id="faceConfidence">‚Äî</span></p>
            <img id="faceMascot" class="mascot" alt="" />
            <p id="faceTip" class="muted"></p>
          </div>
        </div>
      </div>
    </div>
    <div class="navigation-buttons">
      <button id="btnFaceNext" class="btn" disabled>Siguiente Paso</button>
      <button id="btnFaceSkip" class="btn btn-secondary">Saltar</button>
    </div>
  </div>

  <!-- ====================== MEDICI√ìN DE RUIDO ====================== -->
  <div id="screenMeasure" class="screen">
    <div class="step-header">
      <span class="step-counter">Paso 2 de 4</span>
      <h2>Entorno Sonoro</h2>
      <p class="lead">Mediremos el nivel de ruido de tu entorno durante 5 segundos.</p>
    </div>
    <div class="card max-700">
      <div class="gauge-wrapper"><canvas id="gaugeCanvas" width="280" height="280"></canvas><div class="gauge-center"><span id="dbValue" class="db-value">0</span><span class="db-unit">dB</span><div id="dbLabel" class="db-label"></div><div id="countdown" class="countdown">5.0 s</div></div></div>
      <p id="status" class="muted">Presiona "Iniciar" para comenzar la medici√≥n.</p>
      <button id="toggleBtn" class="btn">üéôÔ∏è Iniciar 5s</button>
    </div>
    <div id="noise-results-card" class="card max-700 hidden">
        <h3>Medici√≥n Finalizada</h3>
        <p>El promedio de ruido en tu entorno fue de <b id="final-db-result">-- dB</b>, lo que se considera un ambiente <b id="final-db-label">--</b>.</p>
    </div>
    <div class="navigation-buttons">
      <button id="btnMeasureNext" class="btn" disabled>Siguiente Paso</button>
    </div>
  </div>
  
  <!-- ====================== BODY SCAN ====================== -->
  <div id="screenBodyScan" class="screen">
    <div class="step-header">
      <span class="step-counter">Paso 3 de 4</span>
      <h2>Escaneo Corporal</h2>
      <p class="lead">¬øC√≥mo se siente tu cuerpo ahora? Conecta con tus sensaciones f√≠sicas.</p>
    </div>
    <form id="bodyScanForm">
      <div class="card max-900"><h3>Cabeza y Cuello</h3><div class="slider-group"><label>Nivel de tensi√≥n (1 = relajado, 10 = m√°xima tensi√≥n)</label><input type="range" id="bs_head_tension" min="1" max="10" value="1"><div class="range-ticks"><span>1</span><span>10</span></div></div></div>
      <div class="card max-900"><h3>Hombros y Espalda</h3><div class="slider-group"><label>Nivel de tensi√≥n</label><input type="range" id="bs_upper_tension" min="1" max="10" value="1"><div class="range-ticks"><span>1</span><span>10</span></div></div></div>
      <div class="card max-900"><h3>Pecho y Abdomen</h3><div class="slider-group"><label>Nivel de tensi√≥n</label><input type="range" id="bs_lower_tension" min="1" max="10" value="1"><div class="range-ticks"><span>1</span><span>10</span></div></div></div>
    </form>
    <div class="navigation-buttons"><button id="btnBodyScanNext" class="btn">Siguiente Paso</button></div>
  </div>

  <!-- ====================== JOURNAL ====================== -->
  <div id="screenJournal" class="screen">
      <div class="step-header">
          <span class="step-counter">Paso 4 de 4</span>
          <h2>Tu Espacio</h2>
          <p class="lead">¬øAlgo m√°s en tu mente hoy? A veces, ponerlo en palabras ayuda.</p>
      </div>
      <div class="card max-700">
          <form id="journalForm">
              <textarea id="journal-input" placeholder="Puedes hablar sobre tu carga de trabajo, alguna preocupaci√≥n o algo positivo que haya ocurrido... (Opcional)"></textarea>
              <p class="muted small">Este comentario ser√° confidencial y solo se usar√° para entender el contexto de tu bienestar.</p>
          </form>
      </div>
      <div class="navigation-buttons">
          <button id="btnJournalNext" class="btn">Finalizar y Ver Informe</button>
      </div>
  </div>

  <!-- ====================== INFORME DE BIENESTAR ====================== -->
  <div id="screenIntegration" class="screen">
      <div class="step-header">
          <h2>Tu Informe de Bienestar</h2>
          <p class="lead">Aqu√≠ tienes un resumen de tu check-in de hoy.</p>
      </div>
      <div class="card max-900 report-card">
          <div class="report-header">
              <div id="ix_score_circle" class="score-circle-large">--</div>
              <div class="report-title">
                  <h3 id="ix_label">Calculando...</h3>
                  <p>Tu √çndice de Equilibrio Hoy</p>
              </div>
          </div>
          <div class="report-breakdown">
              <h4>Desglose de tu √çndice:</h4>
              <div class="progress-item">
                  <span class="progress-label">Estado An√≠mico</span>
                  <div class="progress-bar"><div id="ix_face_progress" class="progress-bar-fill"></div></div>
              </div>
              <div class="progress-item">
                  <span class="progress-label">Entorno Sonoro</span>
                  <div class="progress-bar"><div id="ix_db_progress" class="progress-bar-fill"></div></div>
              </div>
              <div class="progress-item">
                  <span class="progress-label">Tensi√≥n Corporal</span>
                  <div class="progress-bar"><div id="ix_bs_progress" class="progress-bar-fill"></div></div>
              </div>
          </div>
          <div class="report-recommendation">
              <h4>Consejo del D√≠a:</h4>
              <p id="ix_reco" class="muted">Analizando tus resultados para darte la mejor recomendaci√≥n...</p>
          </div>
      </div>
      <div class="navigation-buttons">
        <button id="btnIntegrationHome" class="btn">Hacer un Nuevo Check-in</button>
      </div>
  </div>

  <script src="app.js"></script>
</body>
</html>

